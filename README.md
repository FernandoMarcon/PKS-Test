# PKS_Test

The Poisson-Kolmogorov-Smirnov test (PKS Test) software performs a one sample Kolmogorov-Smirnov test for Poisson distribution with
estimated parameter to an ensemble of phylogenetic trees that has been generated by Bayesian phylogeny inference,
and was designed to directly verify whether a phylogeny is clock-like following a Poisson law.

The implementation of the PKS test was done in Python 2.7 with the libraries Numpy, Pylab, Matplotlib, Tkinter to 
perform the calculations, plotting and visual interface.
It was developed by *Fernando Marcon Passos* (http://lattes.cnpq.br/7748192962646791) under supervision of 
*Marcelo R. S. Briones* (http://lattes.cnpq.br/0018992452321910) and *Fernando M. Antoleli Jr.* 
(http://lattes.cnpq.br/4503426222486154) at the _Laboratory of Evolutionary Genomics and Biocomplexity_.

### INPUT
It imports the output NEXUS (_*.nex_) files generated by MrBayes, extract the branch lengths from the
ensemble of tree, which is sorted according to their log-likelihood scores from the lowest to the highest.

The user must select the files through the __Open__ button.

### PARAMETERS
Once the files is selected, the user must specify the parameters:

  * Percetange of trees in which the analysis will be done, and
	* the confidence level desired.
		The PKS critical values are computed using the tables of Campbell and Oprian (1979).
    The user may choose one of the three possible significance levels __α__: 10%, 5% and 1%.

Both parameters has _default values_: 30 % of the available trees and 0.95 for the confidence level.

### OUTPUT
The program outputs the following information:
	(i) the mean value and variance of the log-likelihood scores of the ensemble of trees;
	(ii) the mean and the variance of the ECD of branch lengths, measured in number of substitutions;
	(iii) the PKS statistics DPKS and the PKS critical value Dα for the chosen significance level.

Finally, it is possible to plot the ECD of branch lengths and the expected Poisson cumulative distribution,
through the __Plot__ button.

### HOW TO RUN ON LINUX
Inside the folder with all the files downloaded from github, type on terminal:
		__*$ python PKS_Test.py*__

### REQUIREMENTS
	* Python 2.7
	* scipy
	* PyQt5
	* python-kt
	* pylab
	* collections
	* matplotlib
	* numpy

### EXAMPLE
There is a folder (_Input Exemple Files_) containing files generated by the MrBayes program in which the user
can use to test the program.